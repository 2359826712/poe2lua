local random_str = {}
function random_str.InitCharMap()
  local map = {}
  map['a'] = {
    'a', 'A', 'ａ', 'Ａ',
    'à', 'À', 'á', 'Á', 'â', 'Â', 'ã', 'Ã', 'ä', 'Ä', 'å', 'Å', 'æ', 'Æ',
    'ā', 'Ā', 'ă', 'Ă', 'ą', 'Ą',
    'ǎ', 'Ǎ', 'ǟ', 'Ǡ', 'ǡ', 'ǻ', 'ȁ', 'Ȁ', 'ȃ', 'Ȃ', 'ȧ', 'Ȧ',
    'а', 'А',
    'α', 'Α',
    'ª', '@', '∆',
    '⒜', 'Ⓐ', 'ⓐ', '🅐', '🅰', '🄰'
  }

  map['b'] = {
    'b', 'B', 'ｂ', 'Ｂ',
    'ß', 'β', 'Β',
    'б', 'Б', 'В',
    'ƀ', 'Ƀ', 'ɓ', 'Ɓ',
    'ḃ', 'Ḃ', 'ḅ', 'Ḅ', 'ḇ', 'Ḇ',
    'ℬ',
    '⒝', 'Ⓑ', 'ⓑ', '🅑', '🅱', '🄱'
  }

  map['c'] = {
    'c', 'C', 'ｃ', 'Ｃ',
    'ç', 'Ç', 'ć', 'Ć', 'ĉ', 'Ĉ', 'ċ', 'Ċ', 'č', 'Č',
    'с', 'С',
    '©', '¢', '€',
    'ℭ', 'ℂ',
    '⒞', 'Ⓒ', 'ⓒ', '🅒', '🆄', '🄲'
  }

  map['d'] = {
    'd', 'D', 'ｄ', 'Ｄ',
    'ď', 'Ď', 'đ', 'Đ',
    'ḍ', 'Ḍ', 'ḏ', 'Ḏ', 'ḑ', 'Ḑ', 'ḓ', 'Ḓ',
    'ð', 'Ð',
    'д', 'Д',
    '⒟', 'Ⓓ', 'ⓓ', '🅓', '🆅', '🄳'
  }

  map['e'] = {
    'è', 'È', 'é', 'É', 'ê', 'Ê', 'ë', 'Ë',
    'ē', 'Ē', 'ĕ', 'Ĕ', 'ė', 'Ė', 'ę', 'Ę', 'ě', 'Ě',
    'ȅ', 'Ȅ', 'ȇ', 'Ȇ', 'ȩ', 'Ȩ',
    'е', 'Е', 'ё', 'Ё', 'є', 'Є', 'э', 'Э',
    'ε', 'Ε',
    '£', '€',
    'ℰ',
    '⒠', 'Ⓔ', 'ⓔ', '🅔', '🅴', '🄴'
  }

  map['f'] = {
    'f', 'F', 'ｆ', 'Ｆ',
    'ƒ', 'Ƒ',
    'ḟ', 'Ḟ',
    'ф', 'Ф',
    'ℱ',
    '⒡', 'Ⓕ', 'ⓕ', '🅕', '🅵', '🄵'
  }

  map['g'] = {
    'g', 'G', 'ｇ', 'Ｇ',
    'ĝ', 'Ĝ', 'ğ', 'Ğ', 'ġ', 'Ġ', 'ģ', 'Ģ',
    'ǧ', 'Ǧ', 'Ǵ', 'ǵ',
    'ɠ', 'Ɠ',
    'г', 'Г',
    '⒢', 'Ⓖ', 'ⓖ', '🅖', '🅶', '🄶'
  }

  map['h'] = {
    'h', 'H', 'ｈ', 'Ｈ',
    'ĥ', 'Ĥ', 'ħ', 'Ħ',
    'ḣ', 'Ḣ', 'ḥ', 'Ḥ', 'ḧ', 'Ḧ', 'ḩ', 'Ḩ', 'ḫ', 'Ḫ',
    'н', 'Н',
    'η', 'Η',
    'ℋ', 'ℍ',
    '⒣', 'Ⓗ', 'ⓗ', '🅗', '🅷', '🄷'
  }

  map['i'] = {
    'i', 'I', 'ｉ', 'Ｉ',
    'ì', 'Ì', 'í', 'Í', 'î', 'Î', 'ï', 'Ï',
    'ĩ', 'Ĩ', 'ī', 'Ī', 'ĭ', 'Ĭ', 'į', 'Į', 'ı', 'İ',
    'ǐ', 'Ǐ', 'ȉ', 'Ȉ', 'ȋ', 'Ȋ',
    'і', 'І', 'ї', 'Ї',
    'ι', 'Ι',
    '!', '¡', '|', '1',
    '⒤', 'Ⓘ', 'ⓘ', '🅘', '🅸', '🄸'
  }

  map['j'] = {
    'j', 'J', 'ｊ', 'Ｊ',
    'ĵ', 'Ĵ',
    'ј', 'Ј',
    '⒥', 'Ⓙ', 'ⓙ', '🅙', '🅹', '🄹'
  }

  map['k'] = {
    'k', 'K', 'ｋ', 'Ｋ',
    'ķ', 'Ķ', 'ĸ',
    'ǩ', 'Ǩ',
    'ḱ', 'Ḱ', 'ḳ', 'Ḳ', 'ḵ', 'Ḵ',
    'к', 'К',
    'κ', 'Κ',
    '⒦', 'Ⓚ', 'ⓚ', '🅚', '🅺', '🄺'
  }

  map['l'] = {
    'l', 'L', 'ｌ', 'Ｌ',
    'ĺ', 'Ĺ', 'ļ', 'Ļ', 'ľ', 'Ľ', 'ŀ', 'Ŀ', 'ł', 'Ł',
    'ḷ', 'Ḷ', 'ḹ', 'Ḹ', 'ḻ', 'Ḻ', 'ḽ', 'Ḽ',
    'л', 'Л',
    '£',
    'ℒ',
    '⒧', 'Ⓛ', 'ⓛ', '🅛', '🅻', '🄻'
  }

  map['m'] = {
    'm', 'M', 'ｍ', 'Ｍ',
    'ḿ', 'Ḿ', 'ṁ', 'Ṁ', 'ṃ', 'Ṃ',
    'м', 'М',
    'μ', 'Μ',
    'ℳ',
    '⒨', 'Ⓜ', 'ⓜ', '🅜', '🅼', '🄼'
  }

  map['n'] = {
    'n', 'N', 'ｎ', 'Ｎ',
    'ñ', 'Ñ', 'ń', 'Ń', 'ņ', 'Ņ', 'ň', 'Ň', 'ŉ', 'ŋ', 'Ŋ',
    'ǹ', 'Ǹ',
    'ṅ', 'Ṅ', 'ṇ', 'Ṇ', 'ṉ', 'Ṉ', 'ṋ', 'Ṋ',
    'п', 'П',
    'и', 'И',
    'ℕ',
    '⒩', 'Ⓝ', 'ⓝ', '🅝', '🅽', '🄽'
  }

  map['o'] = {
    'o', 'O', 'ｏ', 'Ｏ',
    'ō', 'Ō', 'ŏ', 'Ŏ', 'ő', 'Ő',
    'ơ', 'Ơ', 'ǒ', 'Ǒ', 'ǫ', 'Ǫ', 'Ǭ', 'ǭ', 'ȍ', 'Ȍ', 'ȏ', 'Ȏ', 'ȫ', 'Ȫ', 'ȭ', 'Ȭ', 'ȯ', 'Ȯ', 'ȱ', 'Ȱ',
    'о', 'О',
    'ο', 'Ο',
    '0', '°', 'º', '¤',
    '⒪', 'Ⓞ', 'ⓞ', '🅞', '🅾', '🄾'
  }

  map['p'] = {
    'p', 'P', 'ｐ', 'Ｐ',
    'ṕ', 'Ṕ', 'ṗ', 'Ṗ',
    'ρ', 'Ρ',
    'р', 'Р',
    'þ', 'Þ',
    'ℙ',
    '⒫', 'Ⓟ', 'ⓟ', '🅟', '🅿'
  }

  map['q'] = {
    'q', 'Q', 'ｑ', 'Ｑ',
    'ɋ', 'Ɋ',
    'ℚ',
    '⒬', 'Ⓠ', 'ⓠ', '🅠', '🆀'
  }

  map['r'] = {
    'r', 'R', 'ｒ', 'Ｒ',
    'ŕ', 'Ŕ', 'ŗ', 'Ŗ', 'ř', 'Ř',
    'ȑ', 'Ȑ', 'ȓ', 'Ȓ',
    'ṙ', 'Ṙ', 'ṛ', 'Ṛ', 'ṝ', 'Ṝ', 'ṟ', 'Ṟ',
    'г', 'Г',
    'я', 'Я',
    '®',
    'ℛ', 'ℜ', 'ℝ',
    '⒭', 'Ⓡ', 'ⓡ', '🅡', '🆁'
  }

  map['s'] = {
    's', 'S', 'ｓ', 'Ｓ',
    'ś', 'Ś', 'ŝ', 'Ŝ', 'ş', 'Ş', 'š', 'Š',
    'ș', 'Ș',
    'ṡ', 'Ṡ', 'ṣ', 'Ṣ', 'ṥ', 'Ṥ', 'ṧ', 'Ṧ', 'ṩ', 'Ṩ',
    'с', 'С',
    '$', '§', '5',
    '⒮', 'Ⓢ', 'ⓢ', '🅢', '🆂'
  }

  map['t'] = {
    'ţ', 'Ţ', 'ť', 'Ť', 'ŧ', 'Ŧ',
    'ț', 'Ț',
    'ṫ', 'Ṫ', 'ṭ', 'Ṭ', 'ṯ', 'Ṯ', 'ṱ', 'Ṱ', 'ẗ',
    'т', 'Т',
    'τ', 'Τ',
    '†', '7',
    '⒯', 'Ⓣ', 'ⓣ', '🅣', '🆃'
  }

  map['u'] = {
    'u', 'U', 'ｕ', 'Ｕ',
    'ù', 'Ù', 'ú', 'Ú', 'û', 'Û', 'ü', 'Ü',
    'ũ', 'Ũ', 'ū', 'Ū', 'ŭ', 'Ŭ', 'ů', 'Ů', 'ű', 'Ű', 'ų', 'Ų',
    'ư', 'Ư', 'ǔ', 'Ǔ', 'ǖ', 'Ǖ', 'ǘ', 'Ǘ', 'ǚ', 'Ǚ', 'ǜ', 'Ǜ',
    'ȕ', 'Ȕ', 'ȗ', 'Ȗ',
    'ụ', 'Ụ', 'ủ', 'Ủ', 'ứ', 'Ứ', 'ừ', 'Ừ', 'ử', 'Ử', 'ữ', 'Ữ', 'ự', 'Ự',
    'у', 'У',
    'µ',
    '⒰', 'Ⓤ', 'ⓤ', '🅤', '🆄'
  }

  map['v'] = {
    'v', 'V', 'ｖ', 'Ｖ',
    'ṽ', 'Ṽ', 'ṿ', 'Ṿ',
    'ν',
    '∨',
    '⒱', 'Ⓥ', 'ⓥ', '🅥', '🆅'
  }

  map['w'] = {
    'w', 'W', 'ｗ', 'Ｗ',
    'ŵ', 'Ŵ',
    'ẁ', 'Ẁ', 'ẃ', 'Ẃ', 'ẅ', 'Ẅ', 'ẇ', 'Ẇ', 'ẉ', 'Ẉ',
    'ш', 'Ш',
    'ω',
    '⒲', 'Ⓦ', 'ⓦ', '🅦', '🆆'
  }

  map['x'] = {
    'x', 'X', 'ｘ', 'Ｘ',
    'ẍ', 'Ẍ', 'ẋ', 'Ẋ',
    'х', 'Х',
    'χ', 'Χ',
    '×',
    '⒳', 'Ⓧ', 'ⓧ', '🅧', '🆇'
  }

  map['y'] = {
    'y', 'Y', 'ｙ', 'Ｙ',
    'ý', 'Ý', 'ÿ', 'Ÿ', 'ŷ', 'Ŷ',
    'ẏ', 'Ẏ', 'ẙ', 'ỳ', 'Ỳ', 'ỵ', 'Ỵ', 'ỷ', 'Ỷ', 'ỹ', 'Ỹ',
    'у', 'У',
    '¥',
    '⒴', 'Ⓨ', 'ⓨ', '🅨', '🆉'
  }

  map['z'] = {
    'z', 'Z', 'ｚ', 'Ｚ',
    'ź', 'Ź', 'ż', 'Ż', 'ž', 'Ž',
    'ƶ', 'Ƶ',
    'ȥ', 'Ȥ',
    'ẑ', 'Ẑ', 'ẓ', 'Ẓ', 'ẕ', 'Ẕ',
    'з', 'З',
    'ζ', 'Ζ',
    'ℤ',
    '⒵', 'Ⓩ', 'ⓩ', '🅩', '🆉'
  }

  return map
end

function random_str.ObfuscateText(input, charMap)
  local out = {}
  for i = 1, #input do
    local c = input:sub(i, i)
    local key = string.lower(c)
    local variants = charMap[key]
    if variants ~= nil and #variants > 0 then
      out[#out + 1] = variants[math.random(#variants)]
    else
      out[#out + 1] = c
    end
  end
  return table.concat(out)
end

local cached_map
function random_str.GetMap()
  if not cached_map then
    cached_map = random_str.InitCharMap()
  end
  return cached_map
end

function random_str.Obfuscate(input)
  return random_str.ObfuscateText(input, random_str.GetMap())
end
return random_str